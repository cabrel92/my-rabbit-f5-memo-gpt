##########################################################
# RabbitMQ Environment Configuration for TLS Inter-node
# & CLI Tools
##########################################################

# Path to Erlang SSL library
# IMPORTANT: Check your Erlang version and installation path
ERL_SSL_PATH="/usr/lib64/erlang/lib/ssl-9.4/ebin"

# ------------------------------
# Additional Erlang VM args for the SERVER node
# ------------------------------
# This applies TLS settings for inter-node communication
RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS="-pa $ERL_SSL_PATH \
  -proto_dist inet_tls \
  -ssl_dist_opt server_certfile /path/to/combined_keys.pem \
  -ssl_dist_opt server_password your_password_here \
  -ssl_dist_opt server_secure_renegotiate true client_secure_renegotiate true"

# ------------------------------
# Additional Erlang VM args for CLI tools
# ------------------------------
# This ensures rabbitmqctl and rabbitmq-diagnostics can communicate over TLS
RABBITMQ_CTL_ERL_ARGS="-pa $ERL_SSL_PATH \
  -proto_dist inet_tls \
  -ssl_dist_opt server_certfile /path/to/combined_keys.pem \
  -ssl_dist_opt server_password your_password_here \
  -ssl_dist_opt server_secure_renegotiate true client_secure_renegotiate true"

# ------------------------------
# Erlang cookie (must be identical across nodes)
# ------------------------------
# Ensure the cookie file /var/lib/rabbitmq/.erlang.cookie contains this value
RABBITMQ_ERLANG_COOKIE="YOUR_SECRET_COOKIE_HERE"

# ------------------------------
# Optional: Erlang distribution port range (recommended for firewalls)
# ------------------------------
#RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS="$RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS -kernel inet_dist_listen_min 35672 inet_dist_listen_max 35680"
#RABBITMQ_CTL_ERL_ARGS="$RABBITMQ_CTL_ERL_ARGS -kernel inet_dist_listen_min 35672 inet_dist_listen_max 35680"

##########################################################
# End of rabbitmq-env.conf
##########################################################
